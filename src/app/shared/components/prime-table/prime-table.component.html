<app-card-layout>
	<p-table
		[(selection)]="input().selectedRows"
		[columns]="input().columns"
		[value]="input().values().data"
		[rows]="input().rowsPerPageOptions[0]"
		[rowsPerPageOptions]="input().rowsPerPageOptions"
		[paginator]="true"
		[scrollable]="true"
		[lazy]="true"
		[totalRecords]="input().values().totalRecords"
		[loading]="input().loading"
		[selectionMode]="input().selectionMode"
		[metaKeySelection]="false"
		(onLazyLoad)="onLazyload($event)"
		dataKey="{{ input().dataKey }}"
		styleClass="prime-table-container"
	>
		<!-- #region Header -->
		<ng-template pTemplate="header" let-columns>
			<tr>
				@for (column of input().columns; track $index) {
					<th
						[frozen]="column.isFrozen"
						[ngStyle]="{ 'min-width': column.minWidth }"
						pFrozenColumn
						alignFrozen="{{ column.alignFrozen }}"
					>
						{{ column.header() }}
					</th>
				}
			</tr>
		</ng-template>
		<!-- #endregion Header -->

		<!-- #region Body -->
		<ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex" let-columns="columns">
			<tr [pSelectableRow]="rowData">
				@for (column of input().columns; track $index) {
					<td
						[frozen]="column.isFrozen"
						[ngStyle]="{ 'min-width': column.minWidth }"
						pFrozenColumn
						alignFrozen="{{ column.alignFrozen }}"
					>
						@switch (column.type.type) {
							@case (PrimeTableColumnTypes.AVATAR) {
								<app-avatar
									[input]="setAvatarColumnType(rowData[column.property], column.type)"
								></app-avatar>
							}
							@case (PrimeTableColumnTypes.BUTTON) {
								<div (click)="clickOptionsButtonColumnType(rowData)">
									<app-button
										[input]="setButtonColumnType(rowData[column.property], column.type, rowIndex)"
									></app-button>
								</div>
							}
							@default {
								@if (column.type.type === PrimeTableColumnTypes.TEXT || !input().editMode) {
									{{ rowData[column.property] }}
								}
								@if (input().editMode) {
									@switch (column.type.type) {
										@case (PrimeTableColumnTypes.INPUT) {
											<app-input
												[input]="
													setInputColumnType(rowData[column.property], column.type, rowIndex)
												"
											></app-input>
										}
									}
								}
							}
						}
					</td>
				}
			</tr>
		</ng-template>
		<!-- #endregion Body -->
	</p-table>
</app-card-layout>
